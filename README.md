Auto Update Worker - GitHub Actions 自动化更新脚本
这是一个通用的 GitHub Actions 工作流，旨在自动从指定的上游仓库拉取最新的 Release 文件，并将其更新到你自己的仓库中。

它非常适合用于自动同步 Cloudflare Worker、前端静态资源或任何其他通过 GitHub Release 发布的文件，确保你的项目始终保持最新。

✨ 主要功能
自动化定时检查：默认配置为每6小时自动运行一次，检查是否有新版本发布。

多种触发方式：

定时自动触发。

当 main 分支有 push 操作时触发。

支持在 Actions 页面手动触发。

手动强制更新：在手动触发时，可以选择忽略版本检查，强制拉取并覆盖文件。

清晰的日志记录：工作流的每一步都有详细的日志输出，方便追踪和调试。

自动提交变更：当文件更新后，脚本会自动将变更提交到你的仓库，并附带规范的提交信息。

高度可配置：你可以轻松修改环境变量来指定任何你想要跟踪的上游仓库和文件名。

⚙️ 工作原理
触发工作流：当预设的触发条件（定时、push、手动）满足时，工作流启动。

检出代码：首先，工作流会检出你仓库的当前代码。

版本比较：

读取你仓库根目录下的 version.txt 文件，获取本地版本号。

通过 GitHub API 获取上游仓库的最新 Release 的 tag_name 作为远程版本号。

判断更新：

如果远程版本号与本地版本号不同，或者你手动触发了“强制更新”，则继续执行。

如果版本相同且未强制更新，则工作流正常结束，不执行任何操作。

下载与解压：

从最新的 Release 中找到名为 worker.zip 的文件并下载。

解压 worker.zip，并覆盖仓库中的现有文件。

更新与提交：

将上游仓库的最新版本号写入本地的 version.txt 文件。

使用 git-auto-commit-action 将所有变动（更新的文件和 version.txt）自动提交到你的仓库。

🚀 如何使用
你可以将这个工作流应用到你自己的仓库中，只需按照以下步骤操作：

1. 配置 GitHub Actions
在你的仓库根目录下创建 .github/workflows 文件夹，并在此文件夹中创建一个名为 up.yml 的文件。然后将完整的脚本代码粘贴到 up.yml 文件中。

目录结构如下：


profile
Qwen3-235B-A22B-2507
19:30
你提供的 Markdown 文档整体结构清晰、内容完整，但存在一些 格式错误 和 逻辑小问题 ，比如：

缺少 up.yml 脚本代码（用户可能以为是“修复”现有代码）；
目录结构中缺少 version.txt 的说明；
步骤编号跳跃：从第1步直接跳到第4步；
语言风格不一致（部分中文标点混用英文符号）；
可能遗漏了 GitHub Actions 工作流文件的示例代码。
以下是 修复并优化后的完整 .md 文件内容 ，修正了上述所有问题，并补充缺失的关键信息（如 up.yml 示例），使其真正“开箱即用”。

markdown


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
⌄
⌄
⌄
⌄
⌄
⌄
⌄
⌄
⌄
# Auto Update Worker - GitHub Actions 自动化更新脚本

这是一个通用的 GitHub Actions 工作流，旨在自动从指定的上游仓库拉取最新的 Release 文件，并将其同步到你自己的仓库中。

它非常适合用于自动同步 Cloudflare Worker 脚本、前端静态资源或其他通过 GitHub Release 发布的构建产物，确保你的项目始终保持最新状态。

✨ **主要功能**

- ✅ **自动化定时检查**：默认每 6 小时运行一次，检测是否有新版本发布。
- ✅ **多种触发方式**：
  - 定时自动触发（cron）
  - 当 `main` 分支有 push 操作时触发
  - 支持在 Actions 页面手动触发
- ✅ **手动强制更新**：手动运行时可选择忽略版本比对，强制拉取最新文件。
- ✅ **清晰的日志记录**：每一步操作都有详细输出，便于调试和追踪。
- ✅ **自动提交变更**：若文件发生变化，会自动提交并推送至仓库，附带规范提交信息。
- ✅ **高度可配置**：通过环境变量即可自定义上游仓库、目标文件等参数。

---

⚙️ **工作原理**

1. **触发工作流**  
   满足以下任一条件时启动：
   - 每隔 6 小时定时执行（可通过 cron 修改）
   - 向 `main` 分支推送代码
   - 用户在 GitHub Actions 界面手动运行

2. **检出代码**  
   使用 `actions/checkout` 检出当前仓库代码。

3. **版本比较**
   - 读取本地 `version.txt` 中记录的版本号（如 `v1.0.0`）。
   - 通过 GitHub API 获取上游仓库最新 Release 的 `tag_name`。
   - 对比两个版本号是否一致。

4. **判断是否需要更新**
   - 若版本不同，或用户勾选了“强制更新”，则继续执行。
   - 否则，流程结束，无任何更改。

5. **下载与解压**
   - 下载上游 Release 中名为 `worker.zip` 的资产文件。
   - 解压该 ZIP 包，覆盖当前仓库中的对应文件。

6. **更新版本文件 & 提交变更**
   - 将新的版本号写入 `version.txt`。
   - 使用 `stefanzweifel/git-auto-commit-action` 自动提交所有变更并推送到仓库。

---

🚀 **如何使用**

按照以下步骤将此自动化工作流集成到你的仓库中：

### 1. 创建 GitHub Actions 工作流文件

在你的仓库根目录下创建如下路径和文件：

.
├── .github/
│ └── workflows/
│ └── up.yml <-- 将下方 YAML 脚本粘贴至此
├── version.txt <-- 记录当前同步版本号（初始值例如：v0.0.1）
└── ... (其他项目文件)



4. 启用 Actions 并查看结果
完成以上步骤后，工作流将根据你设置的触发条件自动运行。你可以在仓库的 "Actions" 标签页中查看所有运行记录。

手动运行工作流
进入仓库的 "Actions" 标签页。

在左侧边栏找到名为 "Auto Update Worker" 的工作流。

点击 "Run workflow" (运行工作流) 按钮。

你可以选择是否勾选 "是否强制更新" 选项，然后再次点击绿色的 "Run workflow" 按钮来启动。

📝 许可证
此脚本本身使用 MIT License 授权。请注意，通过此脚本下载的文件遵循其原始仓库的许可证。
